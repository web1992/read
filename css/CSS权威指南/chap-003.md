# 第3章 特指度和层叠

第 2 章介绍了如何利用文档结构和 CSS 选择符为元素应用各种丰富的样式。每个有效的文档都对应一个树状结构，了解这一点之后便能根据元素的祖辈、属性、同胞元素等创建选择符选择元素。有了树状结构，选择符才能起作用，这也是 CSS 另一个重要方面(继承) 的核心。
继承 (inheritance) 是指把一个元素的某些属性值传给其后代的机制。确定应该把哪些值应用到元素上时，用户代理不仅要考虑继承，还要考虑声明的特指度 (specificity)以及声明的来源。这个过程称为层叠 (cascade) 。本章将探讨特指度、继承和层叠之间的关系，后两个概念之间的区别可以像这样简单理解: 确定 h1 {color: red; color:blue;}的结果是层叠，把 h1 中的 span 显示为蓝色是继承。

- 特指度
- 继承(inheritance)是指把一个元素的某些属性值传给其后代的机制
- 层叠(cascade)
- 通用选择符不增加特指度
- 行内样式声明的特指度比其他声明都高
- !important
- 首先，很多属性是不继承的，这通常是为了避免得到意外的结果（border 属性）
- 


## 特指度

选择符的特指度由选择符本身的组成部分决定。一个特指度值由四部分构成，例如0,0,0,0。选择符的特指度通过下述规则确定:
- 选择符中的每个 ID 属性值加 0,1,0,0。
- 选择符中的每个类属性值、属性选择或伪类加 0,0,1,0。
- 选择符中的每个元素和伪元素加 0,0,0,1。伪类到底有没有特指度在 CSS2 中表述的有些自相矛盾，不过 CSS2.1 明确指出，伪元素有特指度。
- 连结符和通用选择符不增加特指度。

## 层叠

在任何情况下，用户代理都会确定哪些规则与元素匹配，然后找出所有相关的声明，计算各自的特指度，判断哪些规则胜出，再把胜出的规则应用到元素上，得到装饰后的结果。每个元素、选择符和声明都要经历这一系列操作。幸好，用户代理能自动处理一切。这个行为是层叠的重要部分。

## !important

```cs
p.dark {color:#333 !important; background: white;}
```

## 继承

此外，基于同样的原因，多数盒模型属性也不继承，包括外边距、内边距、背景和边框。试想，你肯定不想让段落中的所有链接都从父元素那里继承 30像素的左外边距。

这个例子充分体现了滥用通用选择符的潜在危险。通用选择符能匹配任何元素，它往往会终结继承。这个问题有变通解决方法，但是通常最好从一开始就不滥用通用选择符。
